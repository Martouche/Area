<!doctype html>
<html lang="en">
  <head>
  	<title>Area</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="css/home.css">
  </head>
  <body>

		<div class="d-flex align-items-stretch">
			<nav id="sidebar" class="img" style="background-image: url(images/bg_1.jpg);">
				<div class="p-4">
		  		<h1><a href="home.html" class="logo">AREA<span>Epitech Area</span></a></h1>
	        <ul class="list-unstyled components mb-5">
	          <li class="active">
                <div class="d-flex custom-control custom-switch">
                    <a href="#"><span class="fa fa-spotify mr-3"></span> Spotify </a>
                    <input type="checkbox" class="custom-control-input" id="customSwitchspotify">
                    <label class="custom-control-label place-spotify" for="customSwitchspotify"></label>
                </div>
	          </li>
	          <li>
              <div class="d-flex custom-control custom-switch">
                <a href="#"><span class="fa fa-google mr-3"></span> Google </a>
                <input type="checkbox" class="custom-control-input" id="customSwitchgoogle">
                <label class="custom-control-label place-google" for="customSwitchgoogle"></label>
              </div>
	          </li>
	          <li>
              <div class="d-flex custom-control custom-switch">
                <a href="#"><span class="fa fa-linkedin mr-3"></span> Linkedin </a>
                <input type="checkbox" class="custom-control-input" id="customSwitchlinkedin">
                <label class="custom-control-label place-linkedin" for="customSwitchlinkedin"></label>
              </div>
	          </li>
	          <li>
              <div class="d-flex custom-control custom-switch">
                <a href="#"><span class="fa fa-github mr-3"></span> GitHub </a>
                <input type="checkbox" class="custom-control-input" id="customSwitchgithub">
                <label class="custom-control-label place-github" for="customSwitchgithub"></label>
              </div>
	          </li>
	          <li>
              <div class="d-flex custom-control custom-switch">
                <a href="#"><span class="fa fa-facebook mr-3"></span> Facebook </a>
                <input type="checkbox" class="custom-control-input" id="customSwitchfacebook">
                <label class="custom-control-label place-facebook" for="customSwitchfacebook"></label>
              </div>
              </li>
              <li>
                <div class="d-flex custom-control custom-switch">
                  <a href="#"><span class="fa fa-twitter mr-3"></span> Twitter </a>
                  <input type="checkbox" class="custom-control-input" id="customSwitchtwitter">
                  <label class="custom-control-label place-twitter" for="customSwitchtwitter"></label>
                </div>
              </li>
              <li>
                <div class="d-flex custom-control custom-switch">
                  <a href="#"><span class="fa fa-discord mr-3"></span> Discord </a>
                  <input type="checkbox" class="custom-control-input" id="customSwitchdiscord">
                  <label class="custom-control-label place-discord" for="customSwitchdiscord"></label>
                </div>
              </li>
              <li>
                <div class="d-flex custom-control custom-switch">
                  <a href="#"><span class="fa fa-reddit mr-3"></span> Reddit </a>
                  <input type="checkbox" class="custom-control-input" id="customSwitchreddit">
                  <label class="custom-control-label place-reddit" for="customSwitchreddit"></label>
                </div>
              </li>
              <li>
                <div class="d-flex custom-control custom-switch">
                  <a href="#"><span class="fa fa-twitch mr-3"></span> Twitch </a>
                  <input type="checkbox" class="custom-control-input" id="customSwitchtwitch">
                  <label class="custom-control-label place-twitch" for="customSwitchtwitch"></label>
                </div>
              </li>
              <li>
                <a href="/logout"><span class="fa fa-sign-out mr-3 "></span> Log out</a>
              </li>
	        </ul>

	        <div class="footer fixed-bottom p-4">
	        	<p>Area, Epitech project</p>
	        </div>

	      </div>
    	</nav>

        <!-- Page Content  -->
      <div id="content" class="p-4 p-md-5 pt-5">
          <h2 class="mb-4">Votre compte</h2>
          <p>Vous pouvez retrouver ici tous vos services</p>
          <select id="ListActions" name="Actions">
          </select>
          <input name="ActionValueInput" type="text">
          <select id="ListReaction" name="Reaction">
          </select>
          <input name="ReactionValueInput" type="text">
          <button type="button" onclick="<a href=></a>">Add service</button>
          <div id = "AllActionReactionOfUser"> MES ACTIONS REACTIONS</div>
      </div>

        </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/core.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>
    <script>
    var url = window.location.href;
    var id = url.substring(url.lastIndexOf('=') + 1);
    var tmp;
    $.ajax({
        type: "GET",
        url: ("http://localhost:8080/getServiceForUser?userid=" + id),
        dataType: "json",
        async: false,
        success: function(data) {
            tmp = data;
            for (var i = 0; i < data.length; i++) {
                document.getElementById("customSwitch" + data[i]).checked = true;
            }
        },
        error: function(data) {
            alert("mauvaise réponse du serveur");
        }
    });
    $.ajax({
        type: "GET",
        url: ("http://localhost:8080/getActionForUser?userid=" + id),
        dataType: "json",
        async: false,
        success: function(data) {
            for (var i = 0; i < data.length; i++) {
                console.log("ma data ", data[i]);
                option = document.createElement( 'option' );
                option.value = option.text = data[i];
                document.getElementById("ListActions").add( option );
            }
        },
        error: function(data) {
            alert("mauvaise réponse du serveur");
        }
    });
    $.ajax({
        type: "GET",
        url: ("http://localhost:8080/getReactionForUser?userid=" + id),
        dataType: "json",
        async: false,
        success: function(data) {
            for (var i = 0; i < data.length; i++) {
                console.log("ma data ", data[i]);
                option = document.createElement( 'option' );
                option.value = option.text = data[i];
                document.getElementById("ListReaction").add( option );
            }
        },
        error: function(data) {
            alert("mauvaise réponse du serveur");
        }
    });
    $.ajax({
        type: "GET",
        url: ("http://localhost:8080/getActionReactionByUser?userid=" + id),
        dataType: "json",
        async: false,
        success: function(data) {
            for (var i = 0; i < data.length; i++) {
                console.log("ma data ", data[i]);
                // IL FAUT ZAJOUTER LE BUTON DELETE AVEC LE HREF ET FAIRE LA FONCITON LA ROUTE DES DELET ACTIONS REACTIONS
                $("#AllActionReactionOfUser").append("<div> "+ data[i] +" </div>");
            }
        },
        error: function(data) {
            alert("mauvaise réponse du serveur");
        }
    });

    $("#customSwitchspotify").on( "click", function() {
      if ($("#customSwitchspotify").is(':checked') && tmp.includes("spotify") == false) {
          console.log("tmpp -->>>", tmp[0]);
        document.location.href="http://localhost:8080/oauth2/autorize/spotify"
      }
      else {
        document.location.href="http://localhost:8080/oauth2/logout/spotify?userid=" + id;
      }
    });

    $("#customSwitchgoogle").on( "click", function(tmp) {
      if ($("#customSwitchgoogle").is(':checked') && tmp.includes("google") == false) {
        document.location.href="http://localhost:8080/oauth2/autorize/google"
      }
      else
        document.location.href="http://localhost:8080/oauth2/logout/google?userid=" + id;
    });
    $("#customSwitchlinkedin").on( "click", function() {
      if ($("#customSwitchlinkedin").is(':checked') && tmp.includes("linkedin") == false) {
        document.location.href="http://localhost:8080/oauth2/autorize/linkedin"
      }
      else
        document.location.href="http://localhost:8080/oauth2/logout/linkedin?userid=" + id;
    });
    $("#customSwitchgithub").on( "click", function() {
      if ($("#customSwitchgithub").is(':checked') && tmp.includes("github") == false) {
        document.location.href="http://localhost:8080/oauth2/autorize/github"
      }
      else
        document.location.href="http://localhost:8080/oauth2/logout/github?userid=" + id;
    });
    $("#customSwitchfacebook").on( "click", function() {
      if ($("#customSwitchfacebook").is(':checked') && tmp.includes("facebook") == false) {
        document.location.href="http://localhost:8080/oauth2/autorize/facebook"
      }
      else
        document.location.href="http://localhost:8080/oauth2/logout/facebook?userid=" + id;
     });
     $("#customSwitchtwitter").on( "click", function() {
      if ($("#customSwitchtwitter").is(':checked') && tmp.includes("twitter") == false) {
        document.location.href="http://localhost:8080/oauth2/autorize/twitter"
      }
      else
        document.location.href="http://localhost:8080/oauth2/logout/twitter?userid=" + id;
     });
    $("#customSwitchdiscord").on( "click", function() {
        if ($("#customSwitchdiscord").is(':checked') && tmp.includes("discord") == false) {
          document.location.href="http://localhost:8080/oauth2/autorize/discord"
        }
        else
          document.location.href="http://localhost:8080/oauth2/logout/discord?userid=" + id;
      });
      $("#customSwitchreddit").on( "click", function() {
        if ($("#customSwitchreddit").is(':checked') && tmp.includes("reddit") == false) {
          document.location.href="http://localhost:8080/oauth2/autorize/reddit"
        }
        else
          document.location.href="http://localhost:8080/oauth2/logout/reddit?userid=" + id;
      });
      $("#customSwitchtwitch").on( "click", function() {
        if ($("#customSwitchtwitch").is(':checked') && tmp.includes("twitch") == false) {
          document.location.href="http://localhost:8080/oauth2/autorize/twitch"
        }
        else
          document.location.href="http://localhost:8080/oauth2/logout/twitch?userid=" + id;
      });

    </script>
  </body>
</html>
